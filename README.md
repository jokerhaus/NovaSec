# NovaSec - SIEM/HIDS Platform

[![Go Version](https://img.shields.io/badge/Go-1.22+-blue.svg)](https://golang.org)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Build Status](https://img.shields.io/badge/Build-Passing-brightgreen.svg)]()

**NovaSec** ‚Äî —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è Security Information and Event Management (SIEM) –∏ Host-based Intrusion Detection System (HIDS), —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Wazuh —Å —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –∏ —É–¥–æ–±–Ω—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º.

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** –Ω–∞ Go 1.22+
- **NATS JetStream** –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- **ClickHouse** –¥–ª—è –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
- **PostgreSQL** –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **mTLS** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏ –∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
- **NDJSON** —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ —Å–æ–±—ã—Ç–∏–π
- **DSL –ø—Ä–∞–≤–∏–ª–∞** –¥–ª—è –≥–∏–±–∫–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã** —Å –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ–º –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- **REST API** –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Agent     ‚îÇ    ‚îÇ  Collector  ‚îÇ    ‚îÇ   Ingest    ‚îÇ
‚îÇ             ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ             ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Service   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                              ‚îÇ
                                              ‚ñº
                                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                    ‚îÇ    NATS     ‚îÇ
                                    ‚îÇ  JetStream  ‚îÇ
                                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                              ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚ñº                         ‚ñº                         ‚ñº
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ Normalizer  ‚îÇ         ‚îÇ Correlator  ‚îÇ         ‚îÇ  Alerting   ‚îÇ
            ‚îÇ  Service    ‚îÇ         ‚îÇ  Service    ‚îÇ         ‚îÇ  Service    ‚îÇ
            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ                         ‚îÇ                         ‚îÇ
                    ‚ñº                         ‚ñº                         ‚ñº
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ ClickHouse  ‚îÇ         ‚îÇPostgreSQL   ‚îÇ         ‚îÇ   Admin     ‚îÇ
            ‚îÇ  (Events)   ‚îÇ         ‚îÇ (Metadata)  ‚îÇ         ‚îÇ    API      ‚îÇ
            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Go 1.22+**
- **Docker & Docker Compose**
- **OpenSSL** (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤)
- **4GB RAM** (–º–∏–Ω–∏–º—É–º)
- **20GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞**

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/novasec/novasec.git
cd novasec
```

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

```bash
make init
```

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

```bash
make certs
```

### 4. –°–±–æ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
make build
```

### 5. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
make run
```

### 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
make status
```

## üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Go 1.22+**
   ```bash
   # macOS
   brew install go
   
   # Ubuntu/Debian
   sudo apt update
   sudo apt install golang-go
   
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏
   go version
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker & Docker Compose**
   ```bash
   # macOS
   brew install docker docker-compose
   
   # Ubuntu/Debian
   curl -fsSL https://get.docker.com -o get-docker.sh
   sudo sh get-docker.sh
   sudo usermod -aG docker $USER
   ```

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ OpenSSL**
   ```bash
   # macOS
   brew install openssl
   
   # Ubuntu/Debian
   sudo apt install openssl
   ```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

1. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**
   ```bash
   cp configs/ingest.example.yml configs/ingest.yml
   cp configs/services.example.yml configs/services.yml
   ```

2. **–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**
   ```bash
   # –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–¥—Ä–µ—Å–∞ —Å–µ—Ä–≤–∏—Å–æ–≤, –ø–∞—Ä–æ–ª–∏ –∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
   nano configs/ingest.yml
   nano configs/services.yml
   ```

3. **–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã**
   ```bash
   make certs
   ```

### –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–°–æ–±–µ—Ä–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã**
   ```bash
   make build
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É**
   ```bash
   make run
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å**
   ```bash
   make status
   ```

4. **–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏**
   ```bash
   make logs
   ```

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π

```bash
# –ü—Ä–∏–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ ingest API
curl -X POST http://localhost:8080/api/v1/ingest \
  -H "Content-Type: application/x-ndjson" \
  -H "X-Agent-Id: agent-001" \
  -d '{"ts":"2024-01-15T10:30:00Z","host":"server-01","category":"auth","subtype":"login","message":"Failed login attempt","severity":"high"}'
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤

```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
curl http://localhost:8081/api/v1/alerts

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–ª–µ—Ä—Ç–æ–≤ –ø–æ —Ñ–∏–ª—å—Ç—Ä—É
curl "http://localhost:8081/api/v1/alerts?severity=high&from=2024-01-15T00:00:00Z"
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º–∏

```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–∞–≤–∏–ª
curl http://localhost:8081/api/v1/rules

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞
curl -X POST http://localhost:8081/api/v1/rules \
  -H "Content-Type: application/yaml" \
  -d @internal/rules/login_bruteforce.yml

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞
curl -X POST http://localhost:8081/api/v1/rules/test \
  -H "Content-Type: application/json" \
  -d '{"rule_id":"login_bruteforce","events_fixture":"internal/fixtures/ssh_11_failed.jsonl"}'
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Prometheus –º–µ—Ç—Ä–∏–∫–∏

- **URL**: http://localhost:9090
- **–ú–µ—Ç—Ä–∏–∫–∏**: –°–æ–±—ã—Ç–∏—è, –∞–ª–µ—Ä—Ç—ã, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤

### Grafana –¥–∞—à–±–æ—Ä–¥—ã

- **URL**: http://localhost:3000
- **–õ–æ–≥–∏–Ω**: admin/admin
- **–î–∞—à–±–æ—Ä–¥—ã**: –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã, —Å–æ–±—ã—Ç–∏—è, –∞–ª–µ—Ä—Ç—ã

### Health checks

```bash
# Ingest Service
curl http://localhost:8080/api/v1/health

# Admin API
curl http://localhost:8081/api/v1/health

# NATS
curl http://localhost:8222/healthz

# ClickHouse
curl http://localhost:8123/ping

# PostgreSQL
docker exec novasec-postgres pg_isready -U novasec
```

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
novasec/
‚îú‚îÄ‚îÄ cmd/                    # –û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ ingest/            # –°–µ—Ä–≤–∏—Å –ø—Ä–∏–µ–º–∞ —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ normalizer/        # –°–µ—Ä–≤–∏—Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ correlator/        # –°–µ—Ä–≤–∏—Å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ alerting/          # –°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ adminapi/          # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π API
‚îú‚îÄ‚îÄ internal/               # –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–∞–∫–µ—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ common/            # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ models/            # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ ingest/            # –õ–æ–≥–∏–∫–∞ ingest
‚îÇ   ‚îú‚îÄ‚îÄ normalizer/        # –õ–æ–≥–∏–∫–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ correlator/        # –õ–æ–≥–∏–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ alerting/          # –õ–æ–≥–∏–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ adminapi/          # –õ–æ–≥–∏–∫–∞ –∞–¥–º–∏–Ω API
‚îú‚îÄ‚îÄ configs/                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ docker/                 # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ scripts/                # –°–∫—Ä–∏–ø—Ç—ã —É—Ç–∏–ª–∏—Ç—ã
‚îî‚îÄ‚îÄ docs/                   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
make dev-deps

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
make test

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
make test-coverage

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
make lint

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
make fmt

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏
make debug
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞

1. **–°–æ–∑–¥–∞–π—Ç–µ YAML —Ñ–∞–π–ª –ø—Ä–∞–≤–∏–ª–∞**
   ```yaml
   # internal/rules/example.yml
   id: "example_rule"
   name: "Example Rule"
   description: "Example correlation rule"
   severity: "medium"
   window: "5m"
   group_by: ["host", "user"]
   threshold: 5
   suppress: "15m"
   actions: ["alert"]
   conditions:
     - field: "category"
       operator: "equals"
       value: "auth"
   ```

2. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–æ —á–µ—Ä–µ–∑ API**
   ```bash
   curl -X POST http://localhost:8081/api/v1/rules \
     -H "Content-Type: application/yaml" \
     -d @internal/rules/example.yml
   ```

3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª–æ**
   ```bash
   curl -X POST http://localhost:8081/api/v1/rules/test \
     -H "Content-Type: application/json" \
     -d '{"rule_id":"example_rule","events_fixture":"internal/fixtures/test_events.jsonl"}'
   ```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è**: `make certs`
- **mTLS**: –í–∑–∞–∏–º–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- **–†–æ—Ç–∞—Ü–∏—è**: –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∫–∞–∂–¥—ã–µ 90 –¥–Ω–µ–π

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- **–ê–≥–µ–Ω—Ç—ã**: –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∫–ª–∏–µ–Ω—Ç–æ–≤
- **API**: JWT —Ç–æ–∫–µ–Ω—ã (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –ü–∞—Ä–æ–ª–∏ –∏ SSL

### –°–µ—Ç–µ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **Firewall**: –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç–∞–º
- **VPN**: –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

- **CPU**: 4+ —è–¥—Ä–∞
- **RAM**: 8GB+ (16GB –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
- **Storage**: SSD –¥–ª—è ClickHouse, HDD –¥–ª—è PostgreSQL
- **Network**: 1Gbps+ –¥–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

- **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤
- **–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ**: –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- **–®–∞—Ä–¥–∏–Ω–≥**: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ö–æ—Å—Ç–∞–º

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤ Docker
make monitor

# –õ–æ–≥–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
make logs-ingest | grep "duration_ms"
make logs-correlator | grep "events_processed"
```

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–°–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
   make logs-ingest
   
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
   make check-config
   
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
   make status
   ```

2. **–û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å PostgreSQL
   docker exec novasec-postgres pg_isready -U novasec
   
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PostgreSQL
   docker logs novasec-postgres
   ```

3. **–ü—Ä–æ–±–ª–µ–º—ã —Å NATS**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å NATS
   curl http://localhost:8222/healthz
   
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ NATS
   docker logs novasec-nats
   ```

### –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

```bash
# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
make logs-ingest
make logs-correlator
make logs-alerting

# –õ–æ–≥–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
docker logs novasec-clickhouse
docker logs novasec-postgres
docker logs novasec-redis
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
docker restart novasec-ingest

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã
make stop
make run

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
make clean-all
make init
make certs
make build
make run
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [API Reference](docs/api.md)
- [Configuration Guide](docs/configuration.md)
- [Rule DSL Reference](docs/rules.md)
- [Deployment Guide](docs/deployment.md)
- [Troubleshooting](docs/troubleshooting.md)

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch (`git checkout -b feature/amazing-feature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. Push –≤ branch (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–¥—É

- Go 1.22+
- –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ >80%
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ª–∏–Ω—Ç–µ—Ä—É
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É–±–ª–∏—á–Ω—ã–µ API

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ MIT License - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **Issues**: [GitHub Issues](https://github.com/novasec/novasec/issues)
- **Discussions**: [GitHub Discussions](https://github.com/novasec/novasec/discussions)
- **Wiki**: [GitHub Wiki](https://github.com/novasec/novasec/wiki)

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- [NATS](https://nats.io/) - –°–∏—Å—Ç–µ–º–∞ –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- [ClickHouse](https://clickhouse.com/) - –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –°–£–ë–î
- [PostgreSQL](https://www.postgresql.org/) - –†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –°–£–ë–î
- [Go](https://golang.org/) - –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è

---

**NovaSec** - –ó–∞—â–∏—Ç–∞ –≤–∞—à–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è.
